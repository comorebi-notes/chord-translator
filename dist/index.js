"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.translateType=void 0;var _tonal=require("tonal"),_moji=require("moji"),_moji2=_interopRequireDefault(_moji);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var translateType=exports.translateType=function(a){var b=[0,0,0,null,null,null,null],c=a;c=(0,_moji2.default)(c).convert("ZE","HE").toString(),c=c.replace(/ 　/g,""),c=c.replace(/[＃♯]/g,"#"),c=c.replace(/[♭ｂ]/g,"b");var d=void 0,e=void 0,f=/[\(（]?(omit|no)(\d+)[\)）]?/,g=c.match(f);g&&(e=g[2],c=c.replace(f,""));var h=/\((.+)\)/,i=c.match(h);i&&(d=i[1].replace(/[\s　]+/g,"").split(/[,，]/),c=c.replace(h,""));var j=function(a){return!!c.match(a)&&(c=c.replace(a,""),!0)};switch(!0){case j(/^M(?!(7|9|11|13|aj))/):break;case j(/^m(?!aj)/):b[1]=-1;}switch(!0){case j(/aug5?|\+(?!\d)/):b[2]=1;break;case j(/[Φφø]/):b[1]=-1,b[2]=-1,b[3]=0;}switch(!0){case j(/[\+#]5/):b[2]=1;break;case j(/[-b]5/):b[2]=-1;}switch(!0){case j(/^5/):b[1]=null;break;case j(/^6/):b[3]=-1;break;case j(/^7/):b[3]=0;break;case j(/^9/):b[3]=0,b[4]=0;break;case j(/^11/):b[3]=0,b[4]=0,b[5]=0;break;case j(/^13/):b[3]=0,b[4]=0,b[5]=0,b[6]=0;}switch(!0){case j(/sus4/):b[1]=1;break;case j(/sus2/):b[1]=-2;}switch(!0){case j(/add2/):b[4]=-12;break;case j(/add9/):b[4]=0;break;case j(/add4/):b[5]=-12;break;case j(/add11/):b[5]=0;break;case j(/add6/):b[6]=-12;break;case j(/add13/):b[6]=0;}switch(!0){case j(/(M|[Mm]aj|△|Δ)7/):b[3]=1;break;case j(/(M|[Mm]aj|△|Δ)9/):b[3]=1,b[4]=0;break;case j(/(M|[Mm]aj|△|Δ)11/):b[3]=1,b[4]=0,b[5]=0;break;case j(/(M|[Mm]aj|△|Δ)13/):b[3]=1,b[4]=0,b[5]=0,b[6]=0;}switch(!0){case j(/^(dim|o)7/):b[1]-=1,b[2]-=1,b[3]=-1;break;case j(/^(dim|o)/):b[1]-=1,b[2]-=1;}return d&&(c+=d.join("")),j(/[\+#]5/)&&(b[2]=1),j(/[-b]5/)&&(b[2]=-1),j(/M7/)&&(b[3]=1),j(/7/)&&(b[3]=0),j(/[\+#]9/)&&(b[4]=1),j(/[-b]9/)&&(b[4]=-1),j(/9/)&&(b[4]=0),j(/[\+#]11/)&&(b[5]=1),j(/[-b]11/)&&(b[5]=-1),j(/11/)&&(b[5]=0),j(/[\+#]13/)&&(b[6]=1),j(/[-b]13/)&&(b[6]=-1),j(/13/)&&(b[6]=0),("1"===e?b[0]=null:"3"===e?b[1]=null:"5"===e?b[2]=null:"7"===e?b[3]=null:"9"===e?b[4]=null:"11"===e?b[5]=null:"13"===e?b[6]=null:void 0,0<c.length||2>b.filter(function(a){return null!==a}).length?!1:b)},transposer=function(a,b){return _tonal.Note.fromMidi(_tonal.Note.midi(a)+b)},buildChord=function(a,b,c){var d=[],e=_tonal.Chord.notes(a,"13");e.splice(5,0,_tonal.Distance.transpose(a,"M11"));for(var f=0;7>f;f+=1)null!==c[f]&&d.push(transposer(e[f],c[f]));return d},chordTranslator=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:3,d=_tonal.Chord.notes(""+a+c,"M"),e=translateType(b);if(!e)return!1;var f=buildChord(""+a+c,d,e);return f};exports.default=chordTranslator;